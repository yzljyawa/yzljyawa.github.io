
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title>洛谷 P9529 [JOISC2022] 一流团子师傅 题解 | yzljyのBlog</title>
    <meta name="author" content="yzljy" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/yzljy.PNG" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>YZLJYのBLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;首页</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;关于</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;归档</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;分类</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;标签</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;YZLJYのBLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">首页</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">关于</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">归档</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">分类</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">标签</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>洛谷 P9529 [JOISC2022] 一流团子师傅 题解</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/7/29
        </span>
        
        <span class="category">
            <a href="/categories/OI/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                OI
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/%E9%A2%98%E8%A7%A3/" style="color: #ffa400">
                    题解
                </a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/%E4%BA%A4%E4%BA%92%E9%A2%98/" style="color: #979a9a">
                    交互题
                </a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/%E4%BA%8C%E5%88%86/" style="color: #e74c3c">
                    二分
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p>今天下午学长刚讲了交互题，写完交上去一发过，似乎还是最优解？<br />
<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P9529">题目传送门</a></p>
<h2 id="题意简述">题意简述</h2>
<p>有 <span class="math inline">\(n\)</span> 种物品，每种有 <span
class="math inline">\(m\)</span>
个，现在这些物品被随机打乱了（你并不知道顺序）。你每次可以选择<strong>任意多个</strong>（即给出一个向量）进行询问，每次询问会告诉你这些物品中
<span class="math inline">\(1\)</span> 到 <span
class="math inline">\(n\)</span> 这 <span
class="math inline">\(n\)</span>
种物品中，最少的那种物品的<strong>数量</strong>。最后你需要给出 <span
class="math inline">\(m\)</span>
个<strong>完全不同</strong>的向量，每个向量必须包含这 <span
class="math inline">\(n\)</span>
种物品，每种物品<strong>有且仅有</strong> <span
class="math inline">\(1\)</span> 个，在不多于 <span
class="math inline">\(50000\)</span> 次询问下完成。</p>
<h2 id="思路">思路</h2>
<p>注意到只能在 <span class="math inline">\(50000\)</span>
次询问内完成，而物品最多有 <span class="math inline">\(n \times
m\)</span> 共 <span class="math inline">\(10000\)</span>
个，最后对于每个物品，我们还剩下了 <span
class="math inline">\(5\)</span> 次查询机会。因为 <span
class="math inline">\(m \le 25\)</span>，所以 <span
class="math inline">\(\log m &lt;
5\)</span>，因此我们可以考虑二分（这个其实还是比较难想的？）</p>
<p>我们令 <span class="math inline">\(M\)</span>
表示当前处理的需要提交的向量的数量，<span
class="math inline">\(mid\)</span> 变量表示二分的值，即$mid = $所以当
<span class="math inline">\(M=1\)</span>
的时候，我们就可以提交当前这一个向量。我们每次将一个大向量从前往后一个个遍历（具体方法后面会讲），将其拆成两个小向量，再递归处理，递归到最后直接提交答案，可以计算最多需要询问
<span class="math inline">\(43600\)</span> 次，时间复杂度也是 <span
class="math inline">\(O(n \log m)\)</span> 的，可以通过。</p>
<h2 id="实现">实现</h2>
<p>最开始，我们将 <span class="math inline">\(n \times m\)</span>
这么多个数全部扔进一个叫做 <span class="math inline">\(x\)</span>
的向量中，我们要将 <span class="math inline">\(x\)</span>
这个向量拆成两个小的向量 <span class="math inline">\(y\)</span> 和 <span
class="math inline">\(z\)</span>。使得 <span
class="math inline">\(y\)</span> 这个向量中有 <span
class="math inline">\(mid\)</span> 串未处理的物品，<span
class="math inline">\(z\)</span> 中有 <span
class="math inline">\(M-mid\)</span> 串未处理的物品。</p>
<p>根据查询的性质：返回 <span class="math inline">\(1\)</span> 到 <span
class="math inline">\(n\)</span> 这 <span
class="math inline">\(n\)</span>
种物品中最少的一种物品的数量。因此一个向量可以组成多少个串，就是对这个向量进行询问后的返回值。</p>
<p>因此我们从 <span class="math inline">\(x\)</span>
这个向量的第一个元素开始遍历，假如去掉这一个物品后，我们进行一次查询，发现返回值仍是<strong>大于等于</strong>
<span class="math inline">\(mid\)</span>
的，那么就说明，去掉这个物品后，剩下的物品也至少也可以组成 <span
class="math inline">\(mid\)</span> 个串，那么这个物品就可以扔到 <span
class="math inline">\(z\)</span>
这个向量。反之当返回值<strong>小于</strong> <span
class="math inline">\(mid\)</span>
的时候，就说明去掉这个物品后，剩下的物品不能够组成 <span
class="math inline">\(mid\)</span>
个串，因此这个物品是<strong>必须的</strong>，需要放到 <span
class="math inline">\(y\)</span> 向量。再依次对 <span
class="math inline">\(y\)</span> 和 <span
class="math inline">\(z\)</span> 递归处理，当一个向量长度为 <span
class="math inline">\(n\)</span>
时，那么就说明这是一个合法的串，提交答案即可。</p>
<p><strong>注意！</strong> 当去掉这个物品后，剩下的物品不能组成至少
<span class="math inline">\(mid\)</span> 根串的时候，我们是需要把它扔进
<span class="math inline">\(y\)</span>
这个向量的，但是它<strong>依然</strong>应该被保留在 <span
class="math inline">\(x\)</span>
这个向量中，否则在后面继续遍历的时候，无论如何返回的询问值<strong>总是</strong>小于
<span class="math inline">\(mid\)</span>
的。因此在代码实现的时候，我们其实并不需要真的开两个向量，自然的当 <span
class="math inline">\(x\)</span> 中可以扔去 <span
class="math inline">\(z\)</span> 的扔完后，剩下的其实就是原先<span
class="math inline">\(y\)</span> 这个向量。</p>
<p>具体的，我们维护一个 <span class="math inline">\(pos\)</span>
变量，记录当前应该取的是 <span class="math inline">\(x\)</span>
这个向量中的哪个元素的位置，再另开一个变量记录一下这个元素的值。因为我们有时需要扔进另一个向量，有时需要继续保留。每次我们先将这个元素从向量中弹出，进行查询后根据返回值决定要放回去还是丢进另一个变量。在扔走的时候，<span
class="math inline">\(pos\)</span> 是不变的，当留下的时候，将 <span
class="math inline">\(pos\)</span> 增加 <span
class="math inline">\(1\)</span>。</p>
<p>具体可以看下面几张图来理解： <img
src="https://cdn.luogu.com.cn/upload/image_hosting/2ob88zt8.png" /> <img
src="https://cdn.luogu.com.cn/upload/image_hosting/b2txfmnd.png" /> <img
src="https://cdn.luogu.com.cn/upload/image_hosting/sycpxf00.png" /></p>
<p>为什么这样是正确的？因为我们在每次处理 <span
class="math inline">\(x\)</span> 这个向量时，都保证了处理后的 <span
class="math inline">\(y\)</span> 向量和 <span
class="math inline">\(z\)</span> 向量中，分别可以组合出 <span
class="math inline">\(mid\)</span> 个串和 <span
class="math inline">\(M-mid\)</span> 个串。当最后 <span
class="math inline">\(M=1\)</span> 的时候，也就自然的一定可以组合出
<span class="math inline">\(1\)</span> 个串，因此这也就是答案。</p>
<p>最后处理一些细节，代码也很容易完成，似乎是最短的，就可以愉快地 AC
啦~</p>
<h2 id="代码">代码</h2>
<pre class="cpp"><code>#include &lt;vector&gt;
void Solve(int N, int M);
int Query(const std::vector&lt;int&gt; &amp;x);
void Answer(const std::vector&lt;int&gt; &amp;a);
void work(std::vector&lt;int&gt; &amp;a,int m)&#123;//递归处理
    if(m==1)&#123;//得到答案
        Answer(a);
        return;
    &#125;
    int mid=m/2,cache;
    std::vector&lt;int&gt; x;
    int pos=0;
    int len=a.size();
    for(int i=1;i&lt;=len;i++)&#123;
        cache=a[pos];
        a.erase(a.begin()+pos);
        if(Query(a)&lt;mid) a.insert(a.begin()+pos,cache),pos++;//返回值大于等于mid，扔进另一个向量
        else x.push_back(cache);//返回值小于mid，需要扔回去
    &#125;
    work(a,mid);
    work(x,m-mid);//向下递归继续处理
&#125;
void Solve(int N,int M)&#123;
    std::vector&lt;int&gt; s;
    for(int i=1;i&lt;=N*M;i++) s.push_back(i);//将最开始的N*M个数全部丢进一个初始向量
    work(s,M);
&#125;</code></pre>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
    </div>
    
    
    
    
    <div id="comment">
        <div id="giscus-container" class="giscus"></div>
    </div>
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2024 - 2025 yzljyのBlog
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;yzljy
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    
<script
    src="https://giscus.app/client.js"
    data-repo="yzljyawa/yzljyawa.github.io"
    data-repo-id="R_kgDOMbAUfA"
    data-category="Announcements"
    data-category-id="DIC_kwDOMbAUfM4CiQYe"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    crossorigin
    async
></script>





    
</body>
</html>
